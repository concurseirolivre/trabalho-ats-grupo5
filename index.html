<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simula√ß√£o ATS - Grupo 5</title>
    <style>
        /* --- GERAL --- */
        body {
            background-color: #050505;
            color: #e0e0e0;
            font-family: 'Courier New', Courier, monospace;
            margin: 0;
            height: 100vh;
            overflow: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* =========================================
           ESTILOS DA CAPA (CHUVA E RAIOS CSS)
           ========================================= */
        #cover-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: #050505;
            z-index: 3000; /* Fica acima de tudo */
            display: flex;
            align-items: center;
            justify-content: center;
            font-family: 'Arial Black', sans-serif;
            color: #fff;
            cursor: pointer;
            transition: opacity 1.5s ease-out;
        }

        .rain-back {
            position: absolute; width: 100%; height: 100%;
            background: linear-gradient(to bottom, transparent 50%, rgba(255, 255, 255, 0.1) 100%);
            background-size: 2px 30px; animation: rain-fall-css 0.4s linear infinite; opacity: 0.3; z-index: 1;
        }
        .rain-front {
            position: absolute; width: 100%; height: 100%;
            background: linear-gradient(to bottom, transparent 70%, rgba(255, 255, 255, 0.4) 100%);
            background-size: 3px 25px; animation: rain-fall-css 0.2s linear infinite; opacity: 0.6; z-index: 2;
        }
        .bolt {
            position: absolute; top: -20%; left: 50%; transform: translateX(-50%);
            width: 100px; height: 100vh; background: #fff;
            clip-path: polygon(50% 0%, 30% 60%, 45% 60%, 25% 100%, 75% 40%, 60% 40%, 80% 0%);
            box-shadow: 0 0 80px #fff, 0 0 150px #78aaff; z-index: 3; opacity: 0;
            animation: lightning 6s infinite;
        }
        .flash {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: #fff; z-index: 4; opacity: 0; pointer-events: none;
            animation: flash-screen 6s infinite;
        }
        .content-box {
            position: relative; z-index: 10; background: rgba(0, 0, 0, 0.7);
            padding: 40px 60px; border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 10px; box-shadow: 0 10px 30px rgba(0,0,0,1);
            backdrop-filter: blur(3px); text-align: center;
            animation: shake-text 6s infinite;
        }
        .content-box h1 { margin: 0; font-size: 3rem; text-transform: uppercase; letter-spacing: 5px; text-shadow: 0 0 10px rgba(255,255,255,0.5); }
        .content-box h2 { margin: 5px 0 25px 0; font-size: 1.2rem; color: #ff5252; text-transform: uppercase; letter-spacing: 2px; font-weight: normal; }
        .members { list-style: none; padding: 0; margin: 0; font-family: 'Segoe UI', sans-serif; font-size: 1.1rem; font-weight: 600; color: #cfcfcf; line-height: 1.6; }
        .start-msg { margin-top: 20px; font-size: 0.8rem; color: #888; font-family: monospace; animation: blink 2s infinite; }

        @keyframes rain-fall-css { 0% { background-position: 0px 0px; } 100% { background-position: 20px 100vh; } }
        @keyframes lightning { 0%, 92% { opacity: 0; } 93% { opacity: 1; } 94% { opacity: 0; } 95% { opacity: 0.8; } 96% { opacity: 0; } 100% { opacity: 0; } }
        @keyframes flash-screen { 0%, 92% { opacity: 0; } 93% { opacity: 0.8; } 94% { opacity: 0; } 95% { opacity: 0.4; } 96% { opacity: 0; } 100% { opacity: 0; } }
        @keyframes shake-text { 0%, 92% { transform: translate(0, 0); } 93% { transform: translate(-5px, 5px); } 94% { transform: translate(5px, -5px); } 95% { transform: translate(-5px, -5px); } 96% { transform: translate(0, 0); } }

        /* =========================================
           ESTILOS DO JOGO E PR√ìLOGO
           ========================================= */
        .background-fixed {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background-size: cover; background-position: center; z-index: -5;
            transition: all 1s ease;
        }
        .bg-prologue { filter: brightness(0.4) contrast(1.1); transition: background-image 0.5s ease; }
        .bg-game { background-image: url('img1.jpg'); filter: brightness(0.3) contrast(1.2) blur(2px); }

        /* Efeitos JS (Chuva/Fogo do Jogo) */
        #disaster-layer { position: fixed; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 900; display: none; }
        .rain-js { position: absolute; background: linear-gradient(to bottom, rgba(255,255,255,0), rgba(255,255,255,0.5)); width: 2px; height: 50px; top: -60px; border-radius: 2px; pointer-events: none; }
        .fire-particle { position: absolute; background: radial-gradient(circle, rgba(255,80,0,0.8) 0%, rgba(255,0,0,0) 70%); border-radius: 50%; bottom: -50px; pointer-events: none; filter: blur(4px); mix-blend-mode: screen; }
        @keyframes rain-fall { to { transform: translateY(120vh); } }
        @keyframes rise { 0% { transform: translateY(0) scale(1); opacity: 0.8; } 100% { transform: translateY(-80vh) scale(0); opacity: 0; } }
        
        /* Pr√≥logo Container */
        #prologue-container { width: 90%; max-width: 900px; background-color: rgba(20, 20, 25, 0.95); border: 1px solid #444; border-top: 5px solid #2196F3; border-radius: 8px; padding: 40px; box-shadow: 0 0 50px rgba(0, 0, 0, 0.9); display: none; flex-direction: column; align-items: center; text-align: center; z-index: 1000; animation: fadeIn 1s; position: relative; }
        #prologue-title { color: #2196F3; font-size: 1.5em; text-transform: uppercase; letter-spacing: 2px; margin-bottom: 20px; border-bottom: 1px solid #333; padding-bottom: 10px; width: 100%; }
        #prologue-text { font-size: 1.3em; line-height: 1.6; min-height: 200px; white-space: pre-wrap; margin-bottom: 30px; text-align: left; color: #fff; }
        
        /* Bot√µes */
        .nav-buttons { display: flex; gap: 20px; width: 100%; justify-content: space-between; align-items: center; }
        .btn-prologue { background: transparent; border: 1px solid #2196F3; color: #2196F3; padding: 10px 30px; font-size: 1em; cursor: pointer; transition: all 0.3s; font-family: inherit; }
        .btn-prologue:hover { background: #2196F3; color: white; }

        /* Intro Alert Screen */
        #intro-screen { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.9); z-index: 2000; display: none; flex-direction: column; align-items: center; justify-content: center; text-align: center; opacity: 0; }
        #intro-content h1 { color: #ff3d00; font-size: 4em; margin-bottom: 0; text-transform: uppercase; text-shadow: 0 0 20px rgba(255, 61, 0, 0.8); animation: pulse 1.5s infinite; letter-spacing: 5px; }
        #intro-content h2 { color: #fff; font-weight: normal; margin-top: 10px; font-size: 1.5em; }
        #btn-start-simulation { background: transparent; border: 3px solid #ff3d00; color: #ff3d00; padding: 20px 50px; font-size: 1.8em; font-family: inherit; font-weight: bold; cursor: pointer; margin-top: 50px; transition: all 0.3s; text-transform: uppercase; animation: borderPulse 2s infinite; }
        #btn-start-simulation:hover { background-color: #ff3d00; color: #000; box-shadow: 0 0 30px #ff3d00; }

        /* Game Container */
        #game-container { width: 80%; max-width: 800px; background-color: rgba(20, 20, 20, 0.95); border: 1px solid #444; border-left: 5px solid #d32f2f; border-radius: 8px; padding: 40px; box-shadow: 0 0 30px rgba(0, 0, 0, 0.8); min-height: 400px; display: none; flex-direction: column; opacity: 0; z-index: 500; }
        .header { border-bottom: 1px solid #555; padding-bottom: 10px; margin-bottom: 20px; display: flex; justify-content: space-between; font-size: 0.9em; color: #888; }
        .status-blink { color: #d32f2f; font-weight: bold; animation: blink 1s infinite; }
        #story-text { font-size: 1.2em; line-height: 1.6; white-space: pre-wrap; min-height: 100px; }
        #feedback-area { margin-bottom: 20px; font-weight: bold; padding: 15px; border-radius: 4px; display: none; font-size: 1.1em; }
        .feedback-success { background-color: rgba(46, 125, 50, 0.2); border: 1px solid #2e7d32; color: #81c784; }
        .feedback-error { background-color: rgba(198, 40, 40, 0.2); border: 1px solid #c62828; color: #e57373; }
        .choices { display: flex; flex-direction: column; gap: 10px; margin-top: 30px; opacity: 0; transition: opacity 1s; }
        .btn { background: transparent; border: 1px dashed #FFEB3B; color: #FFEB3B; padding: 15px; text-align: left; font-family: inherit; font-size: 1.1em; cursor: pointer; transition: all 0.2s; }
        .btn:hover { background-color: #FFEB3B; color: #000; border-style: solid; transform: translateX(5px); }
        .cursor { display: inline-block; width: 10px; height: 1em; background-color: #0f0; animation: blink 1s infinite; vertical-align: bottom; }

        @keyframes blink { 0%, 100% { opacity: 1; } 50% { opacity: 0.3; } }
        @keyframes pulse { 0% { transform: scale(1); opacity: 1; } 50% { transform: scale(1.05); opacity: 0.8; } 100% { transform: scale(1); opacity: 1; } }
        @keyframes borderPulse { 0% { box-shadow: 0 0 0 0 rgba(255, 61, 0, 0.7); } 70% { box-shadow: 0 0 0 15px rgba(255, 61, 0, 0); } 100% { box-shadow: 0 0 0 0 rgba(255, 61, 0, 0); } }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    </style>
</head>
<body>

    <div id="cover-screen">
        <div class="rain-back"></div>
        <div class="rain-front"></div>
        <div class="bolt"></div>
        <div class="flash"></div>
        <div class="content-box">
            <h1>GRUPO 05</h1>
            <h2>Cen√°rio: Desastre Ambiental</h2>
            <ul class="members">
                <li>Pedro Cineli</li>
                <li>Alvaro</li>
                <li>Lucas Franklin</li>
                <li>Lucas Barbosa</li>
                <li>Israel</li>
                <li>Renan</li>
            </ul>
            <div class="start-msg">[ CLIQUE PARA INICIAR ]</div>
        </div>
    </div>

    <div class="background-fixed bg-prologue" id="main-bg" style="display:none;"></div>
    <div id="disaster-layer"></div> <audio id="audio-prologue" preload="auto"></audio>
    <audio id="audio-news" src="noticia.mp3" preload="auto"></audio>
    <audio id="audio-game" src="audio.mp3" preload="auto"></audio>

    <div id="prologue-container">
        <div id="prologue-title">INTRODU√á√ÉO T√âCNICA</div>
        <div id="prologue-text"></div>
        
        <div class="nav-buttons">
            <button class="btn-prologue" id="btn-prev-prologue" style="visibility: hidden;">Anterior</button>
            <button class="btn-prologue" id="btn-play-pause" style="min-width: 160px;">‚ñ∂Ô∏è Play</button>
            <button class="btn-prologue" id="btn-next-prologue">Pr√≥ximo ‚ûú</button>
        </div>
    </div>

    <div id="intro-screen">
        <div id="intro-content">
            <h1>ATEN√á√ÉO</h1>
            <h2>SITUA√á√ÉO DE DESASTRE EM ANDAMENTO</h2>
            <h2>A√á√ÉO IMEDIATA NECESS√ÅRIA</h2>
            <button id="btn-start-simulation">INICIAR OPERA√á√ÉO</button>
        </div>
    </div>

    <div id="game-container">
        <div class="header">
            <span>SALA DE SITUA√á√ÉO: GRUPO 5</span>
            <span class="status-blink">‚óè AO VIVO - PETR√ìPOLIS</span>
        </div>
        <div id="feedback-area"></div>
        <div id="text-container">
            <span id="story-text"></span><span class="cursor"></span>
        </div>
        <div id="choices-container" class="choices"></div>
    </div>

<script>
    // --- VARI√ÅVEIS GERAIS ---
    const coverScreen = document.getElementById('cover-screen');
    const prologueContainer = document.getElementById('prologue-container');
    const introScreen = document.getElementById('intro-screen');
    const gameContainer = document.getElementById('game-container');
    const mainBg = document.getElementById('main-bg');
    const disasterLayer = document.getElementById('disaster-layer');
    
    const audioPrologue = document.getElementById('audio-prologue');
    const audioNews = document.getElementById('audio-news');
    const audioGame = document.getElementById('audio-game');
    
    const btnPlayPause = document.getElementById('btn-play-pause');
    const btnNext = document.getElementById('btn-next-prologue');
    const btnPrev = document.getElementById('btn-prev-prologue');
    const btnStartSim = document.getElementById('btn-start-simulation');

    // --- TRANSI√á√ÉO CAPA -> PR√ìLOGO ---
    coverScreen.addEventListener('click', () => {
        // 1. Fade out da capa
        coverScreen.style.opacity = '0';
        
        setTimeout(() => {
            coverScreen.style.display = 'none';
            
            // 2. Prepara e mostra o pr√≥logo
            mainBg.style.display = 'block'; // Mostra o fundo
            prologueContainer.style.display = 'flex'; // Mostra container
            
            // 3. Inicia o pr√≥logo
            updatePrologue();
            
            // Tenta iniciar o √°udio do primeiro slide aqui (clique da capa conta como intera√ß√£o)
            if(prologueData[0].audio) {
                manageAudioState(prologueData[0].audio, true);
            }
        }, 1500);
    });

    // --- DADOS DO PR√ìLOGO ---
    const prologueData = [
        {
            title: "IN√çCIO",
            text: "\"Quando um desastre acontece ‚Äî seja um deslizamento, um inc√™ndio ou uma enchente ‚Äî o caos domina os primeiros minutos.\n\nMas existe uma l√≥gica m√©dica por tr√°s das decis√µes que salvam vidas. Hoje voc√™ vai entender como funciona a atua√ß√£o do m√©dico em cen√°rios de desastre, desde os primeiros passos at√© as situa√ß√µes mais complexas.\"",
            img: "https://www.pragmatismopolitico.com.br/wp-content/uploads/2018/05/acidente-cuba-e1527030296940.jpg",
            audio: "audio1.mp3",
            effectType: 'rain' 
        },
        {
            title: "O PAPEL DO M√âDICO",
            text: "\"Um desastre √© qualquer evento que ultrapassa a capacidade normal de resposta do sistema de sa√∫de. O m√©dico assume pap√©is que v√£o muito al√©m do consult√≥rio.\"",
            img: "https://images.unsplash.com/photo-1584036561566-baf8f5f1b144?auto=format&fit=crop&w=1920&q=80",
            audio: "audio2.mp3"
        },
        {
            title: "TRIAGEM (M√âTODO START)",
            text: "\"A triagem √© o cora√ß√£o da resposta m√©dica. O m√©todo START baseia-se em: Respira√ß√£o, Perfus√£o e Estado Mental.\"",
            img: "https://images.unsplash.com/photo-1516574187841-69301976e49e?auto=format&fit=crop&w=1920&q=80",
            audio: "audio3.mp3"
        },
        {
            title: "SITUA√á√ïES SIMPLES",
            text: "\"A maioria das demandas s√£o simples: ferimentos leves, ansiedade. O m√©dico atua como estabilizador.\"",
            img: "https://www.saude.sp.gov.br/resources/hospital-leonor-mendes-de-barros/acesso-rapido/primeiros-socorros-em-caso-de-incendio.jpg",
            audio: "audio4.mp3"
        },
        {
            title: "ALTA COMPLEXIDADE",
            text: "\"Em inc√™ndios: Intoxica√ß√£o por mon√≥xido. Em deslizamentos: S√≠ndrome do Esmagamento. Decis√µes baseadas em fisiologia.\"",
            img: "https://ogimg.infoglobo.com.br/in/23946251-8e9-d10/FT1086A/GettyImages-56441651.jpg",
            audio: "audio5.mp3",
            effectType: 'fire'
        },
        {
            title: "LOG√çSTICA E LIDERAN√áA",
            text: "\"O m√©dico coordena fluxos e conversa com bombeiros. No abrigo: vigil√¢ncia e preven√ß√£o de surtos.\"",
            img: "https://cdn.folhape.com.br/img/c/1200/900/dn_arquivo/2020/01/medico1.jpg",
            audio: "audio6.mp3"
        },
        {
            title: "A ESS√äNCIA",
            text: "\"No fim, atuar em um desastre √© equilibrar ci√™ncia, humanidade e estrat√©gia. Exige coragem e organiza√ß√£o.\"",
            img: "https://blog.unyleyamed.com.br/wp-content/uploads/2023/09/shutterstock_661890763-scaled.webp",
            audio: "audio7.mp3"
        }
    ];

    let currentPrologueIndex = 0;
    let disasterInterval;

    // --- EFEITOS VISUAIS JS ---
    function startDisasterEffect(type) {
        disasterLayer.style.display = 'block';
        disasterLayer.innerHTML = '';
        clearInterval(disasterInterval);

        if (type === 'rain') {
            disasterInterval = setInterval(() => {
                for(let i=0; i<4; i++) {
                    const drop = document.createElement('div');
                    drop.className = 'rain-js';
                    drop.style.left = Math.random() * 100 + 'vw';
                    drop.style.height = (Math.random() * 20 + 30) + 'px';
                    drop.style.animation = `rain-fall ${Math.random() * 0.3 + 0.5}s linear`;
                    disasterLayer.appendChild(drop);
                    setTimeout(() => { drop.remove(); }, 1000);
                }
            }, 50);
        } else if (type === 'fire') {
            disasterInterval = setInterval(() => {
                for(let i=0; i<3; i++) {
                    const ember = document.createElement('div');
                    ember.className = 'fire-particle';
                    ember.style.left = Math.random() * 100 + 'vw';
                    ember.style.width = (Math.random() * 20 + 5) + 'px';
                    ember.style.height = ember.style.width;
                    const color = Math.random() > 0.5 ? 'rgba(255,80,0,0.8)' : 'rgba(255,200,0,0.6)';
                    ember.style.background = `radial-gradient(circle, ${color} 0%, rgba(255,0,0,0) 70%)`;
                    ember.style.animation = `rise ${Math.random() * 1.5 + 1}s ease-out forwards`;
                    disasterLayer.appendChild(ember);
                    setTimeout(() => { ember.remove(); }, 2500);
                }
            }, 80);
        }
    }

    function stopDisasterEffect() {
        clearInterval(disasterInterval);
        disasterLayer.innerHTML = '';
        disasterLayer.style.display = 'none';
    }

    // --- CONTROLE DE √ÅUDIO ---
    function manageAudioState(audioFile, shouldPlay = true) {
        if (!audioPrologue.paused) audioPrologue.pause();
        
        if (audioPrologue.getAttribute('src') !== audioFile) {
            audioPrologue.src = audioFile;
            audioPrologue.load();
        }

        if (shouldPlay) {
            audioPrologue.play().then(() => {
                btnPlayPause.innerText = "‚è∏Ô∏è Pausar Narra√ß√£o";
            }).catch(e => {
                console.log("Autoplay blocked");
                btnPlayPause.innerText = "‚ñ∂Ô∏è Tocar Narra√ß√£o";
            });
        } else {
            btnPlayPause.innerText = "‚ñ∂Ô∏è Tocar Narra√ß√£o";
        }
    }

    function updatePrologue() {
        const data = prologueData[currentPrologueIndex];
        document.getElementById('prologue-title').innerText = data.title;
        document.getElementById('prologue-text').innerText = data.text;
        mainBg.style.backgroundImage = `url('${data.img}')`;
        mainBg.className = "background-fixed bg-prologue";

        if (data.effectType) startDisasterEffect(data.effectType);
        else stopDisasterEffect();

        btnPrev.style.visibility = currentPrologueIndex === 0 ? 'hidden' : 'visible';
        
        if (currentPrologueIndex === prologueData.length - 1) {
            btnNext.innerText = "IR PARA A√á√ÉO ‚ö†";
            btnNext.style.borderColor = "#ff3d00";
            btnNext.style.color = "#ff3d00";
        } else {
            btnNext.innerText = "Pr√≥ximo ‚ûú";
            btnNext.style.borderColor = "#2196F3";
            btnNext.style.color = "#2196F3";
        }
        
        // Se for clique de navega√ß√£o, toca autom√°tico
        if(currentPrologueIndex > 0) manageAudioState(data.audio, true);
    }

    btnNext.addEventListener('click', () => {
        if (currentPrologueIndex < prologueData.length - 1) {
            currentPrologueIndex++;
            updatePrologue();
        } else {
            stopDisasterEffect();
            audioPrologue.pause();
            
            // Transi√ß√£o para ALERTA
            audioNews.currentTime = 0;
            audioNews.play().catch(e => console.error("Erro noticia:", e));
            
            prologueContainer.style.display = 'none';
            mainBg.style.backgroundImage = "url('img1.jpg')";
            mainBg.className = "background-fixed bg-game";
            introScreen.style.display = 'flex';
            setTimeout(() => { introScreen.style.opacity = '1'; }, 50);
        }
    });

    btnPrev.addEventListener('click', () => {
        if (currentPrologueIndex > 0) {
            currentPrologueIndex--;
            updatePrologue();
        }
    });

    btnPlayPause.addEventListener('click', () => {
        if (audioPrologue.paused) {
            audioPrologue.play();
            btnPlayPause.innerText = "‚è∏Ô∏è Pausar Narra√ß√£o";
        } else {
            audioPrologue.pause();
            btnPlayPause.innerText = "‚ñ∂Ô∏è Tocar Narra√ß√£o";
        }
    });

    // --- JOGO ---
    btnStartSim.addEventListener('click', () => {
        audioNews.pause();
        audioGame.currentTime = 0;
        audioGame.play().catch(e => console.error("Erro game audio:", e));
        
        introScreen.style.transition = "opacity 1s";
        introScreen.style.opacity = '0';

        setTimeout(() => {
            introScreen.style.display = 'none';
            gameContainer.style.display = 'flex';
            setTimeout(() => {
                gameContainer.style.opacity = '1';
                gameContainer.style.animation = 'fadeIn 1s ease-out';
                goTo('start');
            }, 100);
        }, 1000);
    });

    // Motor do jogo mantido igual (omitido para brevidade, mas j√° inclu√≠do no script anterior)
    // ... Copie a const story e fun√ß√µes goTo/typeWriter do c√≥digo anterior se precisar ...
    
    const story = {
        "start": { text: "[06:05] CONEX√ÉO ESTABELECIDA...\n\nO deslizamento acabou de acontecer. Qual sua prioridade?", choices: [{ text: "A - Ir para Zona de Impacto", target: "erro_gestao" }, { text: "B - Focar na Gest√£o", target: "fase_2" }] },
        "erro_gestao": { text: "Voc√™ ficou incomunic√°vel e abdicou da gest√£o.", feedback: { type: "error", msg: "ERRO DE GEST√ÉO: Microgerenciamento." }, choices: [{ text: "Reiniciar", target: "start" }] },
        "fase_2": { text: "Decis√£o correta. Como aloca a equipe?", feedback: { type: "success", msg: "ACERTO: Gest√£o de recursos." }, choices: [{ text: "A - 100% Impacto", target: "erro_prevencao" }, { text: "B - 70% Impacto / 30% Abrigos", target: "fase_3" }] },
        "erro_prevencao": { text: "Surto nos abrigos.", feedback: { type: "error", msg: "FALHA NA PREVEN√á√ÉO." }, choices: [{ text: "Tentar Novamente", target: "fase_2" }, { text: "Reiniciar", target: "start" }] },
        "fase_3": { text: "Alerta de Lepto e Respirat√≥rio. Prioridade?", feedback: { type: "success", msg: "ACERTO: Preven√ß√£o." }, choices: [{ text: "A - Profilaxia", target: "erro_clinico" }, { text: "B - Causa Raiz (Intersetorial)", target: "fase_4" }] },
        "erro_clinico": { text: "Enxugando gelo.", feedback: { type: "error", msg: "ERRO DE VIS√ÉO." }, choices: [{ text: "Tentar Novamente", target: "fase_3" }] },
        "fase_4": { text: "R√°dio mudo. O que faz?", feedback: { type: "success", msg: "ACERTO: Intersetorialidade." }, choices: [{ text: "A - Insistir r√°dio", target: "erro_burocracia" }, { text: "B - Ir ao QG", target: "vitoria" }] },
        "erro_burocracia": { text: "Perdeu tempo.", feedback: { type: "error", msg: "FALHA." }, choices: [{ text: "Tentar Novamente", target: "fase_4" }] },
        "vitoria": { text: "MISS√ÉO CUMPRIDA.", feedback: { type: "success", msg: "SUCESSO." }, choices: [{ text: "Reiniciar", target: "start" }] }
    };

    const textElement = document.getElementById('story-text');
    const choicesContainer = document.getElementById('choices-container');
    const feedbackArea = document.getElementById('feedback-area');
    
    function typeWriter(text, i, fnCallback) {
        if (i < text.length) {
            textElement.innerHTML = text.substring(0, i+1) + '<span class="cursor"></span>';
            setTimeout(() => typeWriter(text, i + 1, fnCallback), 15);
        } else { if (fnCallback) fnCallback(); }
    }

    function goTo(sceneId) {
        const scene = story[sceneId];
        textElement.innerHTML = ""; choicesContainer.innerHTML = ""; choicesContainer.style.opacity = "0"; feedbackArea.style.display = "none";
        if (scene.feedback) {
            feedbackArea.style.display = "block";
            feedbackArea.className = scene.feedback.type === 'success' ? 'feedback-success' : 'feedback-error';
            feedbackArea.innerText = (scene.feedback.type === 'success' ? 'üë®‚Äç‚öïÔ∏èüëç ' : 'üë®‚Äç‚öïÔ∏èüëé ') + scene.feedback.msg;
        }
        typeWriter(scene.text, 0, () => renderButtons(scene.choices));
    }

    function renderButtons(choices) {
        choices.forEach(choice => {
            const btn = document.createElement('button');
            btn.innerText = choice.text; btn.className = 'btn';
            btn.onclick = () => goTo(choice.target);
            choicesContainer.appendChild(btn);
        });
        setTimeout(() => choicesContainer.style.opacity = "1", 100);
    }
</script>
</body>
</html>
